import chalk from 'chalk'
import { EnvUtils, Utils } from '../../util'
import { LogLevel, Logger } from './logger.types'

interface TatumDevelopmentLoggerOptions {
  welcome: boolean
  level: LogLevel
}

export class TatumDevelopmentLogger implements Logger {
  private static readonly DISABLE_WELCOME = 'TTM_DISABLE_WELCOME'
  private static isWelcomeDisabled(): boolean {
    if (!EnvUtils.isProcessAvailable()) return false
    return process.env[TatumDevelopmentLogger.DISABLE_WELCOME] === 'true'
  }

  private static disableWelcome(): void {
    if (!EnvUtils.isProcessAvailable()) return
    process.env[TatumDevelopmentLogger.DISABLE_WELCOME] = 'true'
  }

  private readonly options: TatumDevelopmentLoggerOptions
  private readonly logger = console

  private readonly _trace = chalk.gray
  private readonly _debug = chalk.gray
  private readonly _info = chalk.white
  private readonly _warn = chalk.bold.yellow
  private readonly _error = chalk.bold.red

  private readonly _DEBUG = chalk.bgGray.white(' DEBUG ')
  private readonly _INFO = chalk.bgCyan.gray(' INFO ')
  private readonly _WARN = chalk.bgYellowBright.black(' WARN ')
  private readonly _ERROR = chalk.bgRedBright.bold.yellow(' ERROR ')

  constructor(options: Partial<TatumDevelopmentLoggerOptions> = {}) {
    const defaultOptions: TatumDevelopmentLoggerOptions = {
      welcome: EnvUtils.isDevelopment() && !TatumDevelopmentLogger.isWelcomeDisabled(),
      level: LogLevel.INFO,
    }

    this.options = { ...defaultOptions, ...options }

    if (this.options.welcome) {
      this.welcome()
      TatumDevelopmentLogger.disableWelcome()
    }
  }

  private welcome(): void {
    this.logger.log([LOGO, Utils.randomElementOf(WELCOME_MESSAGES)].join('\n'))
  }

  trace(...args: unknown[]): void {
    if (this.options.level > LogLevel.TRACE) return
    this.logger.trace(this._trace(...args))
  }

  debug(...args: unknown[]): void {
    if (this.options.level > LogLevel.DEBUG) return
    this.logger.debug(this._DEBUG, this._debug(...args))
  }

  info(...args: unknown[]): void {
    if (this.options.level > LogLevel.INFO) return
    this.logger.info(this._INFO, this._info(...args))
  }

  warn(...args: unknown[]): void {
    if (this.options.level > LogLevel.WARN) return
    this.logger.warn(this._WARN, this._warn(...args))
  }

  error(...args: unknown[]): void {
    if (this.options.level > LogLevel.ERROR) return
    this.logger.error(this._ERROR, this._error(...args))
  }
}

const LOGO = `--------------------------------------------------------------------------------
                              
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;79mt[39m[38;5;79mt[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mf[39m[38;5;79mf[39m[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m
[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;79mt[39m[38;5;79mt[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mL[39m[38;5;79mf[39m[38;5;79mf[39m[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m
[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;79m1[39m[38;5;79m1[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mf[39m[38;5;79mt[39m[38;5;79mt[39m[39m[38;5;60m [39m[38;5;60m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m,[39m
[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mt[39m[38;5;99mt[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;99mi[39m[38;5;99mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[39m[38;5;60m [39m[38;5;60m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;60m [39m[38;5;60m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;60m [39m[38;5;60m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;60m [39m[38;5;60m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;60m [39m[38;5;60m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m,[39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m
[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;99mf[39m[38;5;99mf[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99mL[39m[38;5;99m1[39m[38;5;99m1[39m[38;5;60m [39m[38;5;60m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;16m [39m[38;5;60m:[39m[38;5;60m:[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60mi[39m[38;5;60m:[39m[38;5;60m:[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;16m [39m[38;5;16m [39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m;[39m[38;5;60m [39m[38;5;60m [39m[38;5;60m,[39m[38;5;60mi[39m[38;5;60mi[39m
            
--------------------------------------------------------------------------------`

const WELCOME_MESSAGES = [
  `
              Hi! 👋 Welcome to Tatum, the Javascript SDK for Web3.

      Visit our docs to see how Tatum will help you launch projects fast:
                             ${chalk.blueBright('https://co.tatum.io/docs')}
  `,
  `
              Hi! 👋 Welcome to Tatum, the Javascript SDK for Web3.

                    Kick start by making your first RPC call:
                            ${chalk.blueBright('https://co.tatum.io/start')}
  `,
  `
              Hi! 👋 Welcome to Tatum, the Javascript SDK for Web3.

        Possibilities are endless - see what apps you can build with Tatum:
                             ${chalk.blueBright('https://co.tatum.io/apps')}
  `,
  `
              Hi! 👋 Welcome to Tatum, the Javascript SDK for Web3.
                          
    ${chalk.bold('FREE Testnet Tokens')}: Explore Tatum's Faucets available for over 5 chains: 
                           ${chalk.blueBright('https://co.tatum.io/faucets')}
`,
]
